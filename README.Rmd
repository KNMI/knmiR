---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# knmiR

[![Build Status](https://travis-ci.org/MartinRoth/knmiR.png?branch=master)](https://travis-ci.org/MartinRoth/knmiR)
[![Coverage Status](https://img.shields.io/codecov/c/github/MartinRoth/knmiR/master.svg)](https://codecov.io/github/MartinRoth/knmiR?branch=master)

```{r, Libraries, echo=FALSE}
library(DiagrammeR)
library(DiagrammeRsvg)
library(magrittr)
library(htmlwidgets)
library(webshot)
```

```{r, CreateExampleGraph, include=FALSE}
#graph <-
#  create_graph() %>%
#  set_graph_name("DAG") %>%
#  set_global_graph_attrs("graph", "overlap", "true") %>%
#  set_global_graph_attrs("graph", "fixedsize", "true") %>%
#  set_global_graph_attrs("node", "color", "blue") %>%
#  set_global_graph_attrs("node", "fontname", "Helvetica") %>%
#  add_n_nodes(11) %>%
#  select_nodes_by_id(c(1:4, 8:11)) %>% 
#  set_node_attrs_ws("shape", "box") %>%
#  clear_selection %>%
#  select_nodes_by_id(5:7) %>% 
#  set_node_attrs_ws("shape", "circle") %>%
#  clear_selection %>%
#  add_edges_w_string(
#    "1->5 2->6 3->9 4->7 5->8 5->10 7->11", "green") %>%
#  add_edges_w_string(
#    "1->8 3->6 3->11 3->7 5->9 6->10", "red") %>%
#  select_edges("rel", "green") %>%
#  set_edge_attrs_ws("color", "green") %>%
#  invert_selection %>%
#  set_edge_attrs_ws("color", "red") 

#graph <- DiagrammeR("graph, A-->B; A-->C; C-->E; B-->D; C-->D; D-->F; E-->F")
#graph <- DiagrammeR("
#sequenceDiagram;
#   customer->>ticket seller: ask for a ticket;
#   ticket seller->>database: seats;
#   alt tickets available
#     database->>ticket seller: ok;
#     ticket seller->>customer: confirm;
#     customer->>ticket seller: ok;
#     ticket seller->>database: book a seat;
#     ticket seller->>printer: print a ticket;
#   else sold out
#     database->>ticket seller: none left;
#     ticket seller->>customer: sorry;
#   end
#")

graph <- DiagrammeR::mermaid("
  graph LR
  A --> B",
  width=20, height=15)
saveWidget(graph, 'tmp.html', selfcontained=FALSE)
webshot('tmp.html',
        file = 'inst/img/example_graph.png',
        vwidth=10, vheight=10)


```

<img src="inst/img/example_graph.png" align="middle">

A package to access KNMI data within R.

Please, if there are any issues of any kind, file an issue [here](https://github.com/MartinRoth/knmiR/issues).

## General
The data can be downloaded ususally in the following scheme `Dataset(location, period, ...)`. The `location` can have the following forms:

-   `integer` identifying the station (in the case of station data)
-   `SpatialPoint` closest station (grid box) time series in the case of station (gridded) data
-   `SpatialPolygon` (or `bbox`) all stations (grid boxes) in the given spatial extent

The `period` is to follow the `xts` form, e.g. `"2010/2015"` for all data in the years 2010-2015.

## Homogenized precipitation data
To use this data please cite [Buishand et al. (2013): Homogeneity of precipitation series in the Netherlands and their trends in the past century](http://onlinelibrary.wiley.com/doi/10.1002/joc.3471/abstract). At the moment the data are obtained via the [KNMI climate explorer](http://climexp.knmi.nl/).

`HomogenPrecip(550, "1910/2015")` obtains the homogenized preciptiation data for the station with stationId 550 for the period 1910 - 2015. The available stations are reported in the data.frame stationMetaData. From this we can see that stationId 550 belongs to De Bilt. With an object `area` (extending `SpatialPolygons`) we can get all precipitation data in the given area, using `HomogenPrecip(area, "1910/2015")`.

## Earthquake data
`Earthquakes("induced")` provides all induced earthquakes from the KNMI earthquake catalogue. Natural, i.e. `tectonic` quakes, are also available. The data can be restricted to a specific area (extending `SpatialPolygons`) and a specific period. For instance `Earthquakes("induced", Groningen, "2015/2016")` obtaines all induced earthquakes for the Groningen reservoir (is shipped with the package) in the years 2015 and 2016. At the moment the earthquake data are obtained via [KNMI Aardbevingscatalogus](https://www.knmi.nl/kennis-en-datacentrum/dataset/aardbevingscatalogus).

## EOBS data

## Hail data
